<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BINOKUB - Jouer pour une Cause</title>
    <link rel="stylesheet" href="style-portail.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        .card-container { display: flex; justify-content: center; gap: 15px; margin: 20px 0; }
        .card-ui {
            background: white; color: black; width: 65px; height: 95px; border-radius: 8px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.5rem; box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            animation: flipIn 0.3s ease-out; /* Animation plus rapide pour la r√©activit√© */
        }
        @keyframes flipIn { from { transform: rotateY(90deg); opacity: 0; } to { transform: rotateY(0deg); opacity: 1; } }
        
        #reward-selector {
            background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin: 15px 0;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }
        .payout-option { cursor: pointer; margin: 0 10px; font-weight: bold; }
        .winner-glow { border: 3px solid #00ff88 !important; box-shadow: 0 0 30px #00ff88 !important; transform: scale(1.1); }
        .win-msg { color: #00ff88; font-weight: bold; margin-top: 10px; }
        
        /* Style pour le bouton re-piocher pour qu'il soit bien visible et tactile */
        .retry-btn {
            background: #222; border: 1px solid var(--cyan); color: var(--cyan);
            padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;
            font-family: inherit; font-weight: bold;
        }
    </style>
</head>
<body>

    <header>
        <h1 class="neon-title">BINOKUB</h1>
        <p style="color:var(--magenta); font-size: 0.8rem; letter-spacing: 2px;">LOGIQUE ‚Ä¢ JEUX ‚Ä¢ SOLIDARIT√â</p>
    </header>

    <main id="main-container">
        <section id="daily-info" class="glass-card">
            <div id="info-header">üìÖ PENS√âE DU JOUR</div>
            <div id="info-content"><p>"Chargement de l'inspiration..."</p></div>
        </section>

        <section class="glass-card" style="border-color: var(--magenta);">
            <h3 style="margin-top:0; color: var(--magenta);">üéóÔ∏è Soutenir la Recherche</h3>
            <p style="font-size: 0.9rem;">Chaque partie jou√©e ici est une incitation √† la g√©n√©rosit√©. Aidez-nous √† faire √©chec au cancer.</p>
            <a href="https://cancer.ca/fr/ways-to-give/personal-donation" target="_blank" style="color: white; font-weight: bold; text-decoration: underline;">Faire un don officiel</a>
        </section>

        <section id="action-zone" class="glass-card">
            <div id="mini-game-preview">
                <h3>Le D√©fi de Jak</h3>
                <p>Comment pr√©f√©rez-vous gagner ?</p>
                <div id="reward-selector">
                    <input type="radio" id="gold" name="payout" value="gold" checked>
                    <label for="gold" class="payout-option">üí∞ OR</label>
                    <input type="radio" id="cash" name="payout" value="cash">
                    <label for="cash" class="payout-option">üíµ ARGENT</label>
                </div>
                <button id="draw-button" onclick="drawCards()" class="main-btn" style="padding: 12px 35px;">PIOCHER</button>
            </div>
            <hr style="width:100%; border:0; border-top:1px solid rgba(255,255,255,0.1); margin: 25px 0;">
            <a href="./HUB/index.html" class="main-btn" style="background: var(--magenta); box-shadow: 0 0 20px var(--magenta);">üéÆ ACC√âDER √Ä L'ARCADE</a>
        </section>
    </main>

    <script>
        const sfxGold = new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3');
        const sfxCash = new Audio('https://assets.mixkit.co/active_storage/sfx/1126/1126-preview.mp3');

        const citations = [
            "L'espoir est le moteur de toute gu√©rison.",
            "La logique nous aide √† comprendre, le c≈ìur nous aide √† agir.",
            "Chaque petit geste est une pierre √† l'√©difice de la recherche.",
            "Le jeu est plus beau quand il sert une noble cause.",
            "La volont√© de gagner est importante, mais la volont√© de se battre est vitale."
        ];

        function updateDailyInfo() {
            const infoContent = document.querySelector('#info-content p');
            const index = Math.floor(Math.random() * citations.length);
            if(infoContent) infoContent.textContent = `"${citations[index]}"`;
        }

        const deck = [
            {n:'A', v:11}, {n:'2', v:2}, {n:'3', v:3}, {n:'4', v:4}, {n:'5', v:5},
            {n:'6', v:6}, {n:'7', v:7}, {n:'8', v:8}, {n:'9', v:9}, {n:'10', v:10},
            {n:'J', v:10}, {n:'Q', v:10}, {n:'K', v:10}
        ];
        const symbols = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];

        function drawCards() {
            const preview = document.getElementById('mini-game-preview');
            
            // On r√©initialise les sons pour permettre un clic rapide
            sfxGold.pause(); sfxGold.currentTime = 0;
            sfxCash.pause(); sfxCash.currentTime = 0;

            const c1 = deck[Math.floor(Math.random() * deck.length)];
            const c2 = deck[Math.floor(Math.random() * deck.length)];
            const s1 = symbols[Math.floor(Math.random() * symbols.length)];
            const s2 = symbols[Math.floor(Math.random() * symbols.length)];
            const total = c1.v + c2.v;

            // --- √âQUILIBRAGE G√âN√âREUX ---
            const isPerfect = (total === 21);
            const isNearPerfect = (total === 20 || total === 19); // Ajout du 19 pour gagner plus souvent
            const isLuckyColor = (s1 === s2); 
            const isLuckySum = (total === 7 || total === 11 || total === 18); // Ajout du 18

            const isWinner = isPerfect || isNearPerfect || isLuckyColor || isLuckySum;

            let html = `
                <div class="card-container">
                    <div class="card-ui ${isWinner ? 'winner-glow' : ''}" style="color: ${(s1==='‚ô•Ô∏è'||s1==='‚ô¶Ô∏è')?'red':'black'}">${c1.n}<br>${s1}</div>
                    <div class="card-ui ${isWinner ? 'winner-glow' : ''}" style="color: ${(s2==='‚ô•Ô∏è'||s2==='‚ô¶Ô∏è')?'red':'black'}">${c2.n}<br>${s2}</div>
                </div>
                <p>Total : <strong>${total}</strong></p>
            `;

            if (isWinner) {
                const type = document.querySelector('input[name="payout"]:checked').value;
                if(type === 'gold') sfxGold.play().catch(e => {}); 
                else sfxCash.play().catch(e => {});

                html += `<p class="win-msg">‚ú® VICTOIRE ! ‚ú®</p>`;
                if(isPerfect) html += `<p><strong>BLACKJACK !</strong> Jak s'incline.</p>`;
                else if(isLuckyColor) html += `<p><strong>Double ${s1} !</strong> Chance visuelle.</p>`;
                else html += `<p>Une tr√®s belle main gagnante !</p>`;
                
                html += `<button onclick="drawCards()" class="main-btn" style="margin-top:10px">REJOUER</button>`;
                confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
            } else {
                html += `<p>Jak garde la main cette fois...</p>
                         <button onclick="drawCards()" class="retry-btn">RE-PIOCHER</button>`;
            }
            preview.innerHTML = html;
        }

        window.onload = updateDailyInfo;
    </script>
</body>
</html>
