<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BINOKUB - Jouer pour une Cause</title>
    <link rel="stylesheet" href="style-portail.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        .card-container { display: flex; justify-content: center; gap: 15px; margin: 15px 0; min-height: 100px; }
        .card-ui {
            background: white; color: black; width: 65px; height: 95px; border-radius: 8px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.5rem; box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            animation: flipIn 0.2s ease-out; /* Animation ultra rapide */
        }
        @keyframes flipIn { from { transform: rotateY(90deg); opacity: 0; } to { transform: rotateY(0deg); opacity: 1; } }
        
        #reward-selector {
            background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px; margin-bottom: 15px;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }
        .winner-glow { border: 3px solid #00ff88 !important; box-shadow: 0 0 30px #00ff88 !important; transform: scale(1.05); }
        .win-msg { color: #00ff88; font-weight: bold; margin: 10px 0; min-height: 20px; }
        #game-status { min-height: 40px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <header>
        <h1 class="neon-title">BINOKUB</h1>
        <p style="color:var(--magenta); font-size: 0.8rem; letter-spacing: 2px;">LOGIQUE ‚Ä¢ JEUX ‚Ä¢ SOLIDARIT√â</p>
    </header>

    <main id="main-container">
        <section id="daily-info" class="glass-card">
            <div id="info-header">üìÖ PENS√âE DU JOUR</div>
            <div id="info-content"><p>"Chargement..."</p></div>
        </section>

        <section class="glass-card" style="border-color: var(--magenta);">
            <h3 style="margin-top:0; color: var(--magenta);">üéóÔ∏è Soutenir la Recherche</h3>
            <p style="font-size: 0.9rem;">Chaque partie jou√©e ici est une incitation √† la g√©n√©rosit√©.</p>
            <a href="https://cancer.ca/fr/ways-to-give/personal-donation" target="_blank" style="color: white; font-weight: bold; text-decoration: underline;">Faire un don officiel</a>
        </section>

        <section id="action-zone" class="glass-card">
            <h3>Le D√©fi de Jak</h3>
            
            <div id="reward-selector">
                <input type="radio" id="gold" name="payout" value="gold" checked>
                <label for="gold" style="margin-right:10px; cursor:pointer;">üí∞ OR</label>
                <input type="radio" id="cash" name="payout" value="cash">
                <label for="cash" style="cursor:pointer;">üíµ ARGENT</label>
            </div>

            <div id="card-display" class="card-container">
                <div class="card-ui" style="opacity:0.2">?</div>
                <div class="card-ui" style="opacity:0.2">?</div>
            </div>

            <div id="game-status">
                <p>Pr√™t √† piocher ?</p>
            </div>

            <button id="main-draw-btn" onclick="drawCards()" class="main-btn" style="padding: 12px 35px; width: 100%;">PIOCHER</button>
            
            <hr style="width:100%; border:0; border-top:1px solid rgba(255,255,255,0.1); margin: 25px 0;">
            <a href="./HUB/index.html" class="main-btn" style="background: var(--magenta);">üéÆ ACC√âDER √Ä L'ARCADE</a>
        </section>
    </main>

    <script>
        const sfxGold = new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3');
        const sfxCash = new Audio('https://assets.mixkit.co/active_storage/sfx/1126/1126-preview.mp3');

        const citations = [
            "L'espoir est le moteur de toute gu√©rison.",
            "La logique nous aide √† comprendre, le c≈ìur nous aide √† agir.",
            "Chaque petit geste est une pierre √† l'√©difice.",
            "Le jeu est plus beau quand il sert une noble cause."
        ];

        const deck = [
            {n:'A', v:11}, {n:'2', v:2}, {n:'3', v:3}, {n:'4', v:4}, {n:'5', v:5},
            {n:'6', v:6}, {n:'7', v:7}, {n:'8', v:8}, {n:'9', v:9}, {n:'10', v:10},
            {n:'J', v:10}, {n:'Q', v:10}, {n:'K', v:10}
        ];
        const symbols = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];

        function drawCards() {
            const cardDisplay = document.getElementById('card-display');
            const gameStatus = document.getElementById('game-status');
            const btn = document.getElementById('main-draw-btn');

            // Force la r√©activit√© imm√©diate
            sfxGold.pause(); sfxGold.currentTime = 0;
            sfxCash.pause(); sfxCash.currentTime = 0;

            const c1 = deck[Math.floor(Math.random() * deck.length)];
            const c2 = deck[Math.floor(Math.random() * deck.length)];
            const s1 = symbols[Math.floor(Math.random() * symbols.length)];
            const s2 = symbols[Math.floor(Math.random() * symbols.length)];
            const total = c1.v + c2.v;

            // --- √âQUILIBRAGE JAK (Gains fr√©quents) ---
            const isPerfect = (total === 21);
            const isHigh = (total >= 18 && total <= 20); // 18, 19, 20 sont gagnants
            const isColor = (s1 === s2);
            const isLucky = (total === 7 || total === 11);

            const isWinner = isPerfect || isHigh || isColor || isLucky;

            // 1. Mise √† jour des cartes
            cardDisplay.innerHTML = `
                <div class="card-ui ${isWinner ? 'winner-glow' : ''}" style="color: ${(s1==='‚ô•Ô∏è'||s1==='‚ô¶Ô∏è')?'red':'black'}">${c1.n}<br>${s1}</div>
                <div class="card-ui ${isWinner ? 'winner-glow' : ''}" style="color: ${(s2==='‚ô•Ô∏è'||s2==='‚ô¶Ô∏è')?'red':'black'}">${c2.n}<br>${s2}</div>
            `;

            // 2. Mise √† jour du message et du bouton
            if (isWinner) {
                const type = document.querySelector('input[name="payout"]:checked').value;
                if(type === 'gold') sfxGold.play().catch(()=>{}); else sfxCash.play().catch(()=>{});

                gameStatus.innerHTML = `<p class="win-msg">‚ú® VICTOIRE (Total: ${total}) ‚ú®</p>`;
                btn.textContent = "REJOUER";
                btn.style.boxShadow = "0 0 20px #00ff88";
                confetti({ particleCount: 120, spread: 70, origin: { y: 0.7 } });
            } else {
                gameStatus.innerHTML = `<p>Total: ${total}. Jak garde la main.</p>`;
                btn.textContent = "RE-PIOCHER";
                btn.style.boxShadow = "none";
            }
        }

        window.onload = () => {
            const info = document.querySelector('#info-content p');
            info.textContent = `"${citations[Math.floor(Math.random() * citations.length)]}"`;
        };
    </script>
</body>
</html>
